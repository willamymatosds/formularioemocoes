<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pesquisa de Avaliação Emocional</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }
    .container {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
    }
    label {
      font-size: 16px;
      display: block;
      margin: 10px 0 5px;
    }
    select, input[type="text"], input[type="submit"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin: 5px 0 20px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    .slider-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .slider {
      width: 80%;
    }
    .submit-btn {
      background-color: #4CAF50;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    .submit-btn:hover {
      background-color: #45a049;
    }
    .center {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>Pesquisa de Avaliação Emocional</h1>
    
    <!-- Dados Demográficos -->
    <form id="surveyForm" action="https://script.google.com/macros/s/AKfycbz2cc2yIJDbzcL75KCsWxYdA4GsB0rRA6z0_XMCuC62B7x9UJv8mIGLsadGBl3Uxep3/exec" method="POST">
      <h2>Dados Demográficos</h2>

      <label for="idade">Qual a sua idade?</label>
      <input type="text" id="idade" name="idade" required>

      <label for="genero">Gênero:</label>
      <select id="genero" name="genero" required>
        <option value="masculino">Masculino</option>
        <option value="feminino">Feminino</option>
      </select>

      <label for="escolaridade">Escolaridade:</label>
      <select id="escolaridade" name="escolaridade" required>
        <option value="Ensino Médio Completo">Ensino Médio Completo</option>
        <option value="Ensino Superior Incompleto">Ensino Superior Incompleto</option>
        <option value="Ensino Superior Completo">Ensino Superior Completo</option>
        <option value="Pós-Graduação">Pós-Graduação</option>
      </select>

      <label for="falante_nativo">Você é falante nativo do português?</label>
      <select id="falante_nativo" name="falante_nativo" required>
        <option value="Sim">Sim</option>
        <option value="Não">Não</option>
      </select>

      <label for="frequencia_leitura">Com que frequência você lê livros ou artigos?</label>
      <select id="frequencia_leitura" name="frequencia_leitura" required>
        <option value="Diariamente">Diariamente</option>
        <option value="Semanalmente">Semanalmente</option>
        <option value="Mensalmente">Mensalmente</option>
        <option value="Raramente">Raramente</option>
        <option value="Nunca">Nunca</option>
      </select>

      <h2>Avaliação da Valência Emocional do Texto</h2>
      
      <div class="center">
        <p>Como você avalia a emoção evocada por este texto?</p>
      </div>

      <div class="slider-container">
        <input type="range" id="avaliacao_valencia" name="avaliacao_valencia" min="0" max="10" step="0.5" value="5" class="slider" required>
      </div>

      <div class="center">
        <p>0 (Muito negativo) - 10 (Muito positivo)</p>
      </div>

      <input type="submit" value="Enviar Resposta" class="submit-btn">
    </form>
  </div>

  <script>
    // Adicionando um evento de envio para o formulário
    document.getElementById('surveyForm').addEventListener('submit', function(event) {
      // Impede o envio tradicional para garantir que a resposta seja enviada para o Apps Script
      event.preventDefault();

      // Coleta os dados do formulário
      var idade = document.getElementById('idade').value;
      var genero = document.getElementById('genero').value;
      var escolaridade = document.getElementById('escolaridade').value;
      var falanteNativo = document.getElementById('falante_nativo').value;
      var frequenciaLeitura = document.getElementById('frequencia_leitura').value;
      var avaliacaoValencia = document.getElementById('avaliacao_valencia').value;

      // Criação do objeto de dados a serem enviados
      var formData = new FormData();
      formData.append('idade', idade);
      formData.append('genero', genero);
      formData.append('escolaridade', escolaridade);
      formData.append('falante_nativo', falanteNativo);
      formData.append('frequencia_leitura', frequenciaLeitura);
      formData.append('avaliacao_valencia', avaliacaoValencia);

      // Enviar os dados para o Apps Script
      fetch('https://script.google.com/macros/s/AKfycbz2cc2yIJDbzcL75KCsWxYdA4GsB0rRA6z0_XMCuC62B7x9UJv8mIGLsadGBl3Uxep3/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => response.text())
      .then(data => {
        alert('Obrigado pela sua resposta!');
        // Redireciona o usuário para uma nova página ou fecha o formulário, por exemplo
      })
      .catch(error => {
        alert('Ocorreu um erro ao enviar os dados. Tente novamente.');
        console.error('Erro:', error);
      });
    });
  </script>

</body>
</html>
